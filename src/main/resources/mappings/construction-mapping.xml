<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ConstructionDAO">
	<!-- 공사 접수 -->
	<insert id="insertConstruction">
		INSERT INTO construction(con_seq, con_name, sido, gugun, dong, address,
						cp_name, c_num, start_date, end_date, con_num, content) 
		VALUES(con_seq.NEXTVAL, #{con_name}, #{sido}, #{gugun}, #{dong},
			   #{address}, #{cp_name}, #{cp_num}, #{start_date}, #{end_date},
			   #{con_num}, #{content})
	</insert>
	
	<!-- 공사 수정 -->
	<update id="updateConstruction">
		UPDATE construction 
		SET start_date=#{start_date}, end_date=#{end_date}, con_num=#{con_num}
		WHERE con_seq=#{con_seq}
	</update>
	
	<!-- 공사 삭제 -->
	<delete id="deleteConstruction">
		DELETE construction WHERE con_seq=#{con_seq}
	</delete>
	
	<!-- 공사 가져오기 -->
	<select id="getConstruction" resultType="construction">
		SELECT * FROM construction WHERE con_seq=#{con_seq}
	</select>
	
	<!-- 전체 공사 리스트 -->
	<select id="getConstructionList" resultType="construction">
		SELECT * FROM construction
	</select>
	
	<!-- 지역으로 공사 찾기 -->
	<select id="getConstructionListByArea" parameterType="HashMap" resultType="construction">
		SELECT *
		FROM construction
		WHERE sido=#{sido}
		AND gugun LIKE '%'||#{gugun}||'%'
		AND dong LIKE '%'||#{dong}||'%'
	</select>
	
	<!-- 관리 지역 리스트 찾기 --> 
	<select id="getManageConstructionList" parameterType="HashMap" resultType="construction">
		SELECT *
		FROM construction
		WHERE sido=#{sido}
		AND gugun LIKE '%'||#{gugun}||'%'
	</select>
	
	<!-- keyword로 지역 리스트 찾기 -->
	<select id="getConstructionListByKey" parameterType="String" resultType="construction">
		SELECT *
		FROM construction
		WHERE gugun LIKE '%'||#{key}||'%'
		OR dong LIKE '%'||#{key}||'%'
	</select>
</mapper>